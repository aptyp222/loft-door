# ESP32 HomeKit Accessory — Loft Door Relay & Sensor

Этот проект реализует устройство на ESP32 с интеграцией в Apple HomeKit через HomeSpan. Устройство управляет одним реле (например, подсветка лестницы) и отслеживает состояние двери (геркон).

## Функциональность

### ✅ Реле (Loft Relay)
- Управляется из HomeKit.
- Подключено к пину **GPIO22**.
- По умолчанию **выключено** при включении питания.
- **Инвертированная логика**: HIGH — включено, LOW — выключено.
- Автоматически **выключается через 1 минуту** после включения.

### ✅ Датчик двери (Door Sensor)
- Отображается в HomeKit как **датчик открытия**.
- Подключен к пину **GPIO17**.
- Используется **INPUT_PULLUP** (геркон замыкается на землю).
- Встроена защита от дребезга (антидребезг 1 секунда).
- **Не влияет** на управление реле.

## Подключение к Wi-Fi

## Инструкция по сборке

### Подключение:
| Компонент     | GPIO | Назначение       |
|---------------|------|------------------|
| Реле          | 22   | Подсветка (Relay)|
| Геркон (NO)   | 17   | Датчик двери     |

### Зависимости:
- [HomeSpan](https://github.com/HomeSpan/HomeSpan) — библиотека HomeKit для ESP32

Установить HomeSpan можно через Arduino Library Manager или вручную.

## Принцип работы

1. После включения питания ESP32:
   - Устройство подключается к Wi-Fi
   - Реле находится в **выключенном** состоянии
   - Датчик двери отображает текущее состояние

2. При включении реле через HomeKit:
   - Реле включается (HIGH)
   - Через 1 минуту автоматически выключается (LOW)

3. Открытие/закрытие двери не влияет на реле, но отслеживается и передаётся в HomeKit.

---
